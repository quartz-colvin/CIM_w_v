---
title             : "Variation of [v] in Cook Islands Māori"
shorttitle        : "Cook Islands Māori"

author: 
  - name          : "Quartz Colvin"
    affiliation   : "Rutgers University"
    corresponding : no    # Define only one corresponding author
    address       : "Postal address"
    email         : "quartz.colvin@rutgers.edu"

keywords          : "keywords"
wordcount         : "X"

bibliography      : ["r-references.bib"]

figsintext        : yes
figurelist        : yes
tablelist         : yes
footnotelist      : no
lineno            : no

class             : "man"
output            : papaja::apa6_pdf
---

```{r include = FALSE}
#| label: setup-libs

library("tidyverse")
library("papaja")
library("ds4ling")
library("tidyr")
library("here")
library("lme4")
library("mgcv")
library("devtools")
library("broom")
library("ggplot2")
library("lmerTest")
theme_update(# axis labels
             axis.title = element_text(size = 17),
             # tick labels
             axis.text = element_text(size = 10),
             # title 
             title = element_text(size = 20))

source(here::here("scripts", "libs.R"))

untidy_data <- read_csv(here("untidy_data", "cim-v-w-202410.csv"))

```







# 1.0 Introduction

In this paper, we will do a statistical analysis of [v] across a sample of islands in Cook Islands Māori (CIM). It is known that in many dialects and other varieties of Māori, this phoneme can be realized as [w] or [v]. This paper aims to take a statistical approach to this generalization. 

This paper has four sub-questions to investigate. First, how does w~v duration vary by island and second, how does intensity for these phonemes vary by island. The other two questions are about identifying information about the surface forms of w~v by island. Specifically, we will model f0 and f2 to determine whether certain islands have a voiced phoneme realized. Finally, the f2 model will help us determine which islands have higher rates of [w]s surfacing and which have more [v]s surfacing.

## 1.1 Background (CIM)

Cook Islands Māori is an Eastern Polynesian language classified as *Endangered*. It is very closely related to Aotearoa Māori, but is definitely different from it. 

It is known across both Aotearoa (NZ) Māori and CIM that some speakers regularly pronounce [v] as [w], but it is not clear to anyone who does this more and what conditions it.

**???fill in**


# 2.0 Methods

**???fill in**




# 3.0 Data

The following large data set has many columns. Here I show a preview of the data set and then discuss which columns will be relevant to the analysis later in  the paper. 

```{r, fig.align = "center", echo=FALSE, out.width="80%", retina=3}
knitr::include_graphics("./figs/raw_data.png")
```

First, note that there is no 'id' column but there is a column for the speaker's initials. I will use speaker in place of 'id' because that is what was in this original data set. The 'island' column states what island that speaker is from. This data only contains data from the four islands Atiu, Mauke, Penrhyn and Rarotonga. Duration corresponds to the total duration of the phoneme, and intensity is measured at the midpoint of the phoneme.

F0 values were taken at 20%, 50% and 80% of each phoneme's total duration. Later, we will opt to use only the F0 values at 50%, but that will be discussed more later. Finally, F2_midpoint is f2 measured in Hz at the midpoint of that phoneme. 

All of the other columns are either straight-forward information or will be irrelevant for this paper. 

# 4.0 Analysis

This section readdresses the main questions about the w~v alternation. First, how does duration differ by island and second, how does intensity vary by island? Finally, do any islands have regular occurrence of [w] instead of [v] surfacing. For this final question, we will compare f0 and f2 separately. 

Note that in all of my models, I did not control for where w~v occurs in the word, since I am looking at general frequency information and not doing a phonological analysis of specific environments in which [w] or [v] occurs more. Another important thing to note is that for each island, there were different numbers of speakers contributing to the data set. All of the Atiu data came from one speaker and it was the same for Penrhyn. The Mauke data came from four speakers and the Rarotonga data came from five speakers. 

Since there are different numbers of speakers from each of these islands, the models I will use to investigate each question will be linear mixed models. 












## 4.1 Duration by island 

The first step of comparing duration of w~v across these four islands is to make a smaller, tidy data set that only contains the relevant information. 

Below, I filter the data so that it only contains rows with the "v" phoneme. Then I arrange it by island and then by word, and I select only the columns "speaker", "island", "word" and duration. Finally, I save this filtered data set as a new csv file.

```{r}
#| label: tidy-duration
#| echo: true
#| message: false
#| warning: false

tidy_dur <- untidy_data |>
  filter(TextGridLabel == "v") |>  
  arrange(island, Word) |>  
  select(speaker, island, word = Word, duration) |>
  write_csv(here("tidy_data", "tidy_dur.csv"))

```

After we have done this tidying process, the duration data set looks like this. 

```{r, fig.align = "center", echo=FALSE, out.width="60%"}
#| label: glimpse-duration
#| warning: false
#| message: false

knitr::kable(head(tidy_dur))

```

For a visual comparison, we will look at boxplots comparing duration across these four islands. The code chunk for the box plot is here and the actual plot is below it. 

```{r}
#| label: duration-plot
#| warning: false
#| message: false
#| echo: true

plot_dur <- tidy_dur |>
  ggplot() +
  aes(x = island, y = duration, color = island) +
  geom_boxplot() +
  labs(
    title = "Duration by island",
    x = "Island",
    y = "Duration"
  )

```


```{r, fig.align = "center", echo=FALSE, out.width="75%"}
#| label: print-duration-plot
#| warning: false
#| message: false

print(plot_dur)

```

The boxplot shows that average (mean) durations were pretty similar across these three islands. But for some reason, Penrhyn had a much larger range of durations than the other islands. 

Now that we have an idea of what the general differences and similarities are for duration, we can fit the linear mixed effect model. In the code chunk. you can see that I account for the fact that number of speakers varies across the islands in the data set, and also that there are many instances of each word. These instances of each 'word' are repeated by each speaker multiple times and by several speakers multiple times. 


```{r}
#| label: mod-duration
#| echo: true
#| message: false
#| warning: false

mod_dur <- lmer(duration ~ island + (1|speaker) + (1|word), data = tidy_dur)

```


```{r}
#| label: summary-dur
#| echo: false
#| message: false
#| warning: false 

#dur_summary <- summary(mod_dur)

#print(dur_summary)

```

The p-values for each island are as follows. Atiu's p-value = 0.00225, Mauke's p-value = 0.90982, Penrhyn's p-value = 0.32459, and Rarotonga's p-value = 0.25014. 




## 4.2 Intensity by island

Next is the intensity comparison across the four islands. Starting from the raw data set, we must filter it again so that it only has instances of the "v" phoneme and we filter everything except the "speaker", "island", "word", and "intensity" columns. The tidying process is shown in the code chunk here. 

```{r}
#| label: tidy-intensity
#| echo: true
#| warning: false
#| message: false

tidy_intense <- untidy_data |>
  filter(TextGridLabel == "v") |>  
  arrange(island, Word) |>  
  select(speaker, island, word = Word, intensity = intensity_midpoint) |>
  write_csv(here("tidy_data", "tidy_intense.csv"))

```

Once the new data set has been made, it looks roughly like the following table, but extended of course. 

```{r}
#| label: glimpse-intense
#| echo: false
#| message: false
#| warning: false

knitr::kable(head(tidy_intense))

```

In the same way we did for the duration question, we will first look at a boxplot to visually see any clear differences in intensity across the Cook Islands. The code chunk to make the plot is below, and then the actual plot is printed below it. 


```{r}
#| label: intensity-by-island
#| warning: false
#| message: false
#| echo: true

plot_intense <- tidy_intense |>
  ggplot() +
  aes(x = island, y = intensity, color = island) +
  geom_boxplot() +
  labs(
    title = "Intensity by island",
    x = "Island",
    y = "Intensity"
  ) 

```

```{r, fig.align = "center", echo=FALSE, out.width="75%"}
#| label: print-intensity-plot
#| warning: false
#| message: false

print(plot_intense)

```

Initially, it is clear that Penrhyn has the lowest mean intensity for w~v. Mauke and Rarotonga have nearly the same mean intensity, and Atiu's mean is slighly lower, but not as low as Penrhyn's mean.

Now that we know the general patterns, we can fit our linear mixed effects model. Dur to the same reasons as before, I model speaker and word as mixed effects in the intensity by island model. The code chunk below shows how I fit the model in R. 


```{r}
#| label: mod-intensity
#| echo: true
#| message: false
#| warning: false

mod_intense <- lmer(intensity ~ island + (1|speaker) + (1|word), data = tidy_intense)

```

The p-values for each island are as follows. Atiu's p-value = 0.00161, Mauke's p-value = 0.84133, Penrhyn's p-value = 0.62670 and Rarotonga's p-value = 0.86632. 

```{r}
#| label: summary-intense
#| echo: false
#| message: false
#| warning: false

#intense_summary <- summary(mod_intense)

#print(intense_summary)


```


## 4.3 Voicing by island 

Moving on to the formant questions, first we will investigate how voicing of w~v differs across these four islands. 

This time, we tidy the raw data set in a similar way but with one additional step. Since we have f0 values at three different intervals of the same morpheme, if we were to put all of those formant values in a new column and the percentage in another new column, then it would fabricate 3 times as many tokens that were not elicited from the speakers. 

In order to limit this autocorrelation issue, I chose to only keep f0 values at the 50% interval of the phoneme. I chose the 50% interval because the middle of the duration seemed like the smartest choice to represent the average f0 value across the phoneme's duration. 

The code chunk below shows how I tidied this mini-data-set to answer the voicing question. 

```{r}
#| label: tidy-f0
#| echo: true
#| message: false
#| warning: false

tidy_f0 <- untidy_data |>
  filter(TextGridLabel == "v") |>
  pivot_longer(
    cols = c("f0_50.point"), 
    names_to = "percent",
    values_to = "f0"
  ) |>
  arrange(island, Word) |>  
  select(speaker, island, word = Word, f0, duration) |>
  write_csv(here("tidy_data", "tidy_f0.csv"))

```

Once we have made this new, tidy data set, it looks like this. Again, if I showed the full table, it would have more than this one word and this one island. This is just the top few rows of the sorted table.

```{r}
#| label: glimpse-f0
#| echo: false
#| message: false
#| warning: false

knitr::kable(head(tidy_f0))

```

This time, to compare f0 across the islands visually, we can plot this data onto a scatterplot. First, here is the code chunk to create the scatterplots.

```{r}
#| label: plot-f0
#| echo: true
#| message: false
#| warning: false

f0_plot <- tidy_f0 |>
  ggplot() + 
  aes(x = duration, y = f0, color = speaker) +
  geom_point() +
  geom_smooth(
    method="glm",
    color="black",
    method.args = list(family = "poisson")
  ) +
  facet_grid(.~island,
             scales = "free_x") +
  labs(
    title = "F0 by island", 
    x = "Duration", 
    y = "F0 (Hz)"
  ) 
```

As you can see, I created an individual facet for each island and each color represents data from a particular speaker. 

```{r, fig.align = "center", echo=FALSE, out.width="90%", retina=3}
#| label: print-f0-plot
#| message: false
#| warning: false

print(f0_plot)

```

It's clear that the most drastic slope is in the Penrhyn plot, and the data for the islands with more speakers are much more spread out across the plot. 


To formally compare these different variables, we can again use a linear mixed effects model to see how f0 varies across these four Cook Islands. The model fitting is shown in the code chunk below. 

```{r}
#| label: mod-f0
#| echo: true
#| message: false
#| warning: false

mod_f0 <- lmer(f0 ~ island + (1|speaker) + (1|word), data = tidy_f0)

```

The p-values for each island in this model are as follows. Atiu's p-value = 0.00702, Mauke's p-value = 0.43464, Penrhyn's p-value is 0.93276, and Rarotonga's p-value = 0.14965. 


```{r}
#| label: summary-f0
#| echo: false
#| message: false
#| warning: false

#f0_summary <- summary(mod_f0) 

#print(f0_summary)

```

## 4.4 w~v distribution by island

Finally we turn to the main research question: is there a correlation between island and how many [w] tokens surface? 

For this question, we tidy the raw data set once again so that it only has data for "v", speaker, island, word, and f2 values. 

```{r}
#| label: tidy-f2
#| echo: true
#| message: false
#| warning: false

tidy_f2 <- untidy_data |>
  filter(TextGridLabel == "v") |>
  arrange(island, Word) |>  
  select(speaker, island, word = Word, f2 = F2_midpoint) |>
  write_csv(here("tidy_data", "tidy_f2.csv"))

```

Once the data has been tidied, it generally looks like this. 

```{r}
#| label: glimpse-f2
#| echo: false
#| message: false
#| warning: false

knitr::kable(head(tidy_f2))

```

To visually compare the f2 values across these islands, here is a code chunk to generate another boxplot. 

```{r}
#| label: plot-f2
#| echo: true
#| message: false
#| warning: false

f2_plot <- tidy_f2 |>
  ggplot() +
  aes(x = island, y = f2, color = island) +
  geom_boxplot() +
  labs(
    title = "F2 by island",
    x = "Island",
    y = "F2 (Hz)"
  )

```

```{r, fig.align = "center", echo=FALSE, out.width="75%"}
#| label: print-f2-plot
#| warning: false
#| message: false

print(f2_plot)

```

From looking at the f2 boxplot, it's clear that Atiu has the lowest mean f2. The other three islands had more similar means, but Mauke and Penrhyn had some instances of w~v that had extremely high F2 measurements. Regardless, the boxes for each island look different, so we know what to expect when we fit a linear mixed effects model. The code chunk for fitting this model is below.

```{r}
#| label: mod-f2
#| echo: true
#| message: false
#| warning: false

mod_f2 <- lmer(f2 ~ island + (1|speaker) + (1|word), data = tidy_f2)

```


```{r}
#| label: summary-f2
#| message: false
#| echo: false
#| warning: false

#f2_summary <- summary(mod_f2)

#print(f2_summary)

```

The p-values for each island in this model are as follows. Atiu's p-value = 1.52e-05, Mauke's p-value = 0.02190, Penrhyn's p-value = 0.02162, and Rarotonga's p-value = 0.00626. 


## 5.1 Reporting the results

**FILL IN???**

# 6.0 Conclusion

**???fill in**

# References

```{r create_r-references}

#r_refs(file = "r-references.bib")

```


\setlength{\parindent}{-0.5in}
\setlength{\leftskip}{0.5in}

